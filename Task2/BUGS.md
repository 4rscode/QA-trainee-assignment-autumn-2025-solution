# Баг-репорты для API микросервиса объявлений

## BUG-001: Несоответствие формата ответа при создании объявления

**Статус:** Open  
**Приоритет:** High  
**Серьезность:** Critical  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
При успешном создании объявления через POST /api/1/item формат ответа не соответствует документации. Вместо ожидаемых полей возвращается только сообщение о статусе.

### Шаги для воспроизведения
1. Отправить POST запрос на /api/1/item с валидными данными:
```json
{
  "sellerID": 123456,
  "name": "Test Item",
  "price": 9900,
  "statistics": {
    "likes": 21,
    "viewCount": 11,
    "contacts": 43
  }
}
```

2. Получить ответ от сервера

### Ожидаемый результат
```json
{
  "id": "string",
  "sellerId": 123456,
  "name": "Test Item",
  "price": 9900,
  "statistics": {
    "likes": 21,
    "viewCount": 11,
    "contacts": 43
  },
  "createdAt": "2024-01-15T10:30:00Z"
}
```

### Фактический результат
```json
{
  "status": "Сохранили объявление - 96ae5012-fa74-4c73-9ee9-028195ea2c50"
}
```

### Дополнительная информация
- Код ответа: 200 OK
- Поля `id`, `sellerId`, `name`, `price`, `statistics`, `createdAt` отсутствуют в ответе
- Это нарушает контракт API и затрудняет клиентскую разработку

---

## BUG-002: Отсутствие валидации отрицательных цен

**Статус:** Open  
**Приоритет:** High  
**Серьезность:** Major  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Сервер принимает отрицательные значения цены при создании объявления, что является некорректным с бизнес-логикой.

### Шаги для воспроизведения
1. Отправить POST запрос на /api/1/item с отрицательной ценой:
```json
{
  "sellerID": 123456,
  "name": "Test Item",
  "price": -100,
  "statistics": {
    "likes": 21,
    "viewCount": 11,
    "contacts": 43
  }
}
```

2. Получить ответ от сервера

### Ожидаемый результат
- Код ответа: 400 Bad Request
- Сообщение об ошибке валидации цены

### Фактический результат
- Код ответа: 200 OK
- Объявление успешно создается с отрицательной ценой

### Дополнительная информация
- Это может привести к финансовым потерям и некорректной бизнес-логике
- Нулевая цена корректно валидируется (возвращает 400)

---

## BUG-003: Отсутствие валидации отрицательной статистики

**Статус:** Open  
**Приоритет:** High  
**Серьезность:** Major  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Сервер принимает отрицательные значения для полей статистики (likes, viewCount, contacts), что противоречит логике метрик.

### Шаги для воспроизведения
1. Отправить POST запрос на /api/1/item с отрицательной статистикой:
```json
{
  "sellerID": 123456,
  "name": "Test Item",
  "price": 9900,
  "statistics": {
    "likes": -5,
    "viewCount": -10,
    "contacts": -1
  }
}
```

2. Получить ответ от сервера

### Ожидаемый результат
- Код ответа: 400 Bad Request
- Сообщение об ошибке валидации статистики

### Фактический результат
- Код ответа: 200 OK
- Объявление успешно создается с отрицательной статистикой

### Дополнительная информация
- Отрицательные значения для метрик просмотров, лайков и контактов не имеют смысла
- Это может искажать аналитику и отчетность

---

## BUG-004: Некорректная валидация нулевой статистики

**Статус:** Open  
**Приоритет:** Medium  
**Серьезность:** Minor  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Сервер отклоняет нулевые значения для полей статистики, хотя они должны быть допустимыми.

### Шаги для воспроизведения
1. Отправить POST запрос на /api/1/item с нулевой статистикой:
```json
{
  "sellerID": 123456,
  "name": "Test Item",
  "price": 9900,
  "statistics": {
    "likes": 0,
    "viewCount": 0,
    "contacts": 0
  }
}
```

2. Получить ответ от сервера

### Ожидаемый результат
- Код ответа: 200 OK
- Объявление успешно создается с нулевой статистикой

### Фактический результат
- Код ответа: 400 Bad Request
- Сервер отклоняет запрос с нулевой статистикой

## BUG-005: Некорректный статус код при получении существующего объявления

**Статус:** Open  
**Приоритет:** High  
**Серьезность:** Critical  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Эндпоинт GET /api/1/item/:id возвращает статус 400 (Bad Request) вместо 200 (OK) при запросе существующего объявления по валидному ID.

### Шаги для воспроизведения
1. Создать объявление через POST /api/1/item с валидными данными
2. Получить ID созданного объявления из ответа
3. Отправить GET запрос на /api/1/item/{id} с полученным ID

### Ожидаемый результат
- Код ответа: 200 OK
- Тело ответа содержит JSON с данными объявления

### Фактический результат
- Код ответа: 400 Bad Request
- Данные объявления недоступны

### Дополнительная информация
- Баг блокирует основную функциональность получения объявлений
- Нарушает REST контракт API
- Влияет на все клиентские приложения

---

## BUG-006: Некорректный статус код для несуществующих объявлений

**Статус:** Open  
**Приоритет:** High  
**Серьезность:** Major  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Эндпоинт GET /api/1/item/:id возвращает статус 400 (Bad Request) вместо 404 (Not Found) при запросе несуществующего объявления.

### Шаги для воспроизведения
1. Отправить GET запрос на /api/1/item/nonexistent_id_12345
2. Наблюдать за кодом ответа

### Ожидаемый результат
- Код ответа: 404 Not Found
- Четкое указание, что ресурс не найден

### Фактический результат
- Код ответа: 400 Bad Request
- Невозможно отличить невалидный запрос от отсутствующего ресурса

### Дополнительная информация
- Нарушает стандарты HTTP и REST API
- Затрудняет обработку ошибок на клиентской стороне
- Клиенты не могут корректно обрабатывать случаи отсутствия объявлений

---

## BUG-007: Некорректная обработка числовых ID

**Статус:** Open  
**Приоритет:** Medium  
**Серьезность:** Minor  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Эндпоинт GET /api/1/item/:id возвращает статус 400 вместо 404 при запросе с числовым ID, который не существует в системе.

### Шаги для воспроизведения
1. Отправить GET запрос на /api/1/item/123456
2. Наблюдать за кодом ответа

### Ожидаемый результат
- Код ответа: 404 Not Found
- Стандартная обработка несуществующего ресурса

### Фактический результат
- Код ответа: 400 Bad Request
- Несоответствие ожидаемому поведению

### Дополнительная информация
- Хотя числовые ID могут не использоваться системой, ожидается стандартная обработка 404
- Не критично, но нарушает единообразие API

---

## BUG-008: Блокировка тестирования производительности GET эндпоинта

**Статус:** Open  
**Приоритет:** Low  
**Серьезность:** Minor  
**Окружение:** Testing  
**Версия API:** 1.0  

### Описание
Из-за ошибок 400 при валидных запросах невозможно провести тестирование производительности и нагрузочное тестирование эндпоинта GET /api/1/item/:id.

### Шаги для воспроизведения
1. Попытаться выполнить любой тест производительности для GET эндпоинта
2. Наблюдать постоянные ошибки 400

### Ожидаемый результат
- Возможность измерять время ответа для валидных запросов
- Возможность проводить нагрузочное тестирование

### Фактический результат
- Все запросы возвращают 400, делая тесты производительности невозможными

## Баг-репорты для эндпоинта GET /api/1/:sellerID/item

### BUG-009: Некорректный статус код для невалидных sellerID

**Статус:** Open  
**Приоритет:** High  
**Серьезность:** Major  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Эндпоинт GET /api/1/:sellerID/item возвращает статус 405 (Method Not Allowed) вместо 400 (Bad Request) при запросе с невалидным форматом sellerID (строки, специальные символы, пустое значение).

### Шаги для воспроизведения
1. Отправить GET запрос на /api/1/invalid_string/item
2. Отправить GET запрос на /api/1/@#$%^/item  
3. Отправить GET запрос на /api/1//item

### Ожидаемый результат
- Код ответа: 400 Bad Request
- Четкое указание на невалидный параметр

### Фактический результат
- Код ответа: 405 Method Not Allowed
- Невозможно отличить невалидный запрос от неподдерживаемого метода

### Дополнительная информация
- Нарушает стандарты HTTP и REST API
- Затрудняет обработку ошибок на клиентской стороне
- Проявляется для всех нечисловых sellerID

---

### BUG-010: Отсутствие валидации отрицательных sellerID

**Статус:** Open  
**Приоритет:** High  
**Серьезность:** Major  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Эндпоинт GET /api/1/:sellerID/item принимает отрицательные значения sellerID и возвращает статус 200, хотя по документации sellerID должен быть в диапазоне 111111-999999.

### Шаги для воспроизведения
1. Отправить GET запрос на /api/1/-123456/item
2. Наблюдать за кодом ответа

### Ожидаемый результат
- Код ответа: 400 Bad Request
- Сообщение об ошибке валидации sellerID

### Фактический результат
- Код ответа: 200 OK
- Сервер обрабатывает запрос и возвращает данные (или пустой список)

### Дополнительная информация
- Нарушает бизнес-логику приложения
- Может привести к непредсказуемому поведению
- Отрицательные ID не должны быть допустимыми

---

### BUG-011: Некорректная обработка sellerID вне допустимого диапазона

**Статус:** Open  
**Приоритет:** Medium  
**Серьезность:** Minor  
**Окружение:** Production  
**Версия API:** 1.0  

### Описание
Эндпоинт GET /api/1/:sellerID/item возвращает статус 200 для sellerID вне документально заявленного диапазона (111111-999999), например, для 100000 или 1000000.

### Шаги для воспроизведения
1. Отправить GET запрос на /api/1/100000/item
2. Отправить GET запрос на /api/1/1000000/item

### Ожидаемый результат
- Код ответа: 400 Bad Request
- Сообщение о недопустимом sellerID

### Фактический результат
- Код ответа: 200 OK
- Сервер обрабатывает запрос